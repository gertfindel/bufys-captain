<?php
	/*
	*	BUFFY Gift Recommendation Engine
	*	Team Avengers: July 2012
	*/

require_once 'google-api/src/apiClient.php';
require_once 'google-api/src/contrib/apiShoppingService.php';
$client = new apiClient();
$client->setApplicationName("Avengers");

// Visit https://code.google.com/apis/console?api=shopping to generate your
// Simple API Key.
$client->setDeveloperKey('AIzaSyBNGnDm_b4Ijrgfx103ui-uc2Sf_w4pv6c');
global $service; $service = new apiShoppingService($client);

// Valid source values are "public", "cx:cse", and "gan:pid"
// See http://code.google.com/apis/shopping/search/v1/getting_started.html#products-feed

// For more information about full text search with the shopping API, please
// see http://code.google.com/apis/shopping/search/v1/getting_started.html#text-search

//The order in which the API returns products is defined by a ranking criterion.
// See http://code.google.com/apis/shopping/search/v1/getting_started.html#ranking



<<<<<<< .mine
function recommend($aParam, $aOptions) {
=======

function recommend($aParam) {
>>>>>>> .r19
  	global $service;

	if(!is_array($aParam)) {
 		$aParam = array($aParam);
  	}

  	$aOut = array();
  	$aOptions['country'] = 'US';
  	foreach ($aParam as $iKey => $sValue) {
  		$results = $service->products->listProducts("public", array(
  			"country" => "US",
  			"q" => $sValue,
  			"rankBy" => "relevancy",
		));

		if($results['items'][0]) {
			$aOut[] = $results['items'][0];
		}
  	}
  	return $aOut;
}